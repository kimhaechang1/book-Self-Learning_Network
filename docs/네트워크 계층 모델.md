### 프로토콜

두 말단 노드간에 정보를 주고받을때 하나의 약속 혹은 규칙을 의미함.

프로토콜의 예시: IP, ARP, HTTP, HTTPS, TCP, UDP 등

## 네트워크 계층 모델

네트워크 메세지를 송수신하는 이론적인 모델로서 정형화된 단계가 7가지 존재한다고 하여 7 Layer가 된다.

예를들어 A가 B에게 택배를 보내는 예시가 있다고 가정해보자.

중간에 택배를 전달하는 매개체는 택배기사라고 지칭하자.

A입장에서는

```
1. 선물할 Item을 준비한다.
2. Item이 오염되지 않도록 포장용지로 감싼다.
3. 포장된 Item을 배송을 위해 택배 상자에 담는다.
4. 택배 상자에 Item이 담겼을 시 밀봉한다.
5. 택배기사 가 확인할 메시지를 택배 상자에 담는다.
6. 전송을 위한 택배 상자를 택배기사에게 보낸다.
```

B입장에서는

```
1. 택배상자를 택배기사로부터 받는다.
2. 택배 기사에게 필요하였던 정보를 상자에서 제거한다.
3. 택배 상자를 개봉한다.
4. 택배 상자속 포장된 Item을 꺼낸다.
5. 포장용지를 제거한다.
6. Item을 확인한다.
```

마치 서로의 입장이 반대로 이루어져 있다.

이러한 절차가 곧바로 OSI 7 Layer가 되는데, 계층적인 구조로 된 이유는 다음과 같다.

```
각 계층이 수행해야할 역할이 딱 정해져있기에 목적에 맞는 네트워크 장비와 프로토콜로 구성할 수 있다.

계층적이기 때문에 가장 하위 계층에서부터 문제를 진단하여 상위 계층까지 올라가는방식으로 진단할 수 있고, 이에 따라 어느 지점에서 문제가 발생햇는지 확실히 확인가능하다.
```

### OSI 7 Layer

국제 표준화 기구 ISO에서 발표한 네트워크 표준 계층모델 이다.

정처기를 공부했다면 `물 < 데 < 네 < 전 < 세 < 표 < 응` 으로 외우고 있는것들이다.

각각을 알아본다.

1. 물리 계층

    다양한 통신 매체로부터 온 비트신호에 대해서 송 수신이 이뤄지는 계층

2. 데이터 링크 계층

    네트워크 내 주변 장치 간의 정보를 올바르게 주고받기 위한 계층으로서

    물리 계층으로부터 받은 정보의 오류 검사, MAC 주소를 통한 네트워크 내 송 수신지 특정, 충돌문제 해결을 수행한다.

3. 네트워크 계층

    메시지를 다른 네트워크에 속한 수신지 까지 전달하는 계층, 
    
    데이터 링크 계층은 네트워크 내에 기기들 사이의 송 수신이라는 점에서 네트워크계층과는 다르다.

    이 계층에서는 IP 주소를 통해 수신지의 호스트 네트워크를 식별하고 최적경로를 결정

4. 전송 계층

    신뢰성있고 안정성 있는 전송을 해야할 때 필요한 계층

    패킷의 흐름을 제어, 전송 오류를 점검, 포트를 통해 응용프로그램 식별

5. 세션 계층

    통신을 주고받는 호스트의 응용프로그램간 연결상태를 의미하는 세션을 관리하는 계층


6. 표현 계층

    사람이 이해할수 있는 문자를 컴퓨터가 이해할 수 있는 코드로 변환하거나 압축, 암호화같은 작업이 이루어짐

7. 응용 계층

    응용프로그램과 가장 맞닿아 있는 계층으로서 사용자가 사용할 응용 프로그램에 다양한 네트워크 서비스를 제공한다.

여기까지가 OSI 7 Layer이고 이 이론적인 계층을 그대로 사용하기엔 힘드니까

실용적인 모델인 TCP/IP 모델을 사용한다. 

### TCP/IP 모델

TCP/IP 모델은 이론보다는 구현에 중점을 둔 네트워크 모델이다.

다른 말로는 TCP/IP 4계층, 인터넷 프로토콜 수이트, TCP/IP 프로토콜 스택이라고도 한다.

1. 네트워크 엑세스 계층

    링크 계층 또는 네트워크 인터페이스 계층이라고도 부르며, 전통적으로 OSI 7 Layer의 데이터링크 계층과 유사한 역할을 수행하고, 물리 계층과는 거의 연관이 없다.

    그래서 다른 공식문서에서는 5 Layer로 표현하는데, 여기 네트워크 엑세스 계층을 두 가지로 나뉘어서 물리계층과 데이터 링크계층으로 표현하는 곳도 있다.

2. 인터넷 계층

    인터넷 계층은 OSI 7 Layer의 3계층인 네트워크 계층과 유사하다.

3. 전송 계층 

4. 응용 계층

    OSI 7 Layer의 세션 계층, 표현 계층, 응용 계층을 모두 합친것과 유사하다.


## 캡슐화와 역 캡슐화

아까 A와 B사이에 택배를 주고받는 과정이 기억 날 것이다.

그기서 택배를 보내는 사람은 가장 최상위 계층에서부터 전송할 데이터를 감싸고

```
Item을 포장하고, 포장한것을 택배박스에 넣고 택배 박스에 수신자 정보 넣고 등
```

택배를 받는 사람은 최하위 계층에서부터 최상위 계층까지 올라간다.

```
택배 기사한테 필요한 정보는 제거하고, 택배박스에서 포장된 Item을 꺼내고, 포장을 풀고, Item확인하고
```

이 과정에서 최상위 계층부터 최 하위 계층으로 페이로드에 각 계층별 헤더를 붙이는 과정을 `캡슐화` 라고 하고 그 반대를 `역 캡슐화`라고 한다.

즉, 캡슐화에서는 상위 계층의 패킷이 하위 계층의 페이로드로 간주되고, 해당 페이로드에 해당 계층에서 담을 헤더 혹은 트레일러가 붙게 된다.

역 캡슐화는 반대니깐 최하위 계층에서부터 패킷에서 계층별로 필요한 헤더와 정보를 읽고 상위 계층으로 현재 계층에서 읽은 헤더를 떼고 올려보낸다.

### PDU

각 계층에서 송수신 되는 메시지의 단위를 `PDU(Protocol Data Unit)`이라고 한다.

상위 계층에서 전달받은 뎅터에 현재 계층의 프로토콜 헤더 혹은 트레일러를 추가하면 현재 계층의 `PDU`가 된다.

각 계층별로 PDU 명칭이 다르다.

- 물리계층: 비트단위를 전송 매체에 따라 송수신 하는 계층으로서 비트(bit)이다.

- 데이터 링크 계층: 프레임(frame)

- 네트워크 계층: 패킷(Packet)

- 전송 계층: 세그먼트(Segment), 데이타 그램(Datagrame)

- 세션 계층, 표현 계층, 응용 계층: 데이터(Data)


### 트래픽과 네트워크 성능 지표

`트래픽`이란 네트워크 내의 정보량을 의미한다. 이러한 트래픽이 특정 노드에 몰리게 되면 `과부하(Overhead)`가 생길 수 있다.

`처리율`(`쓰루풋 throughput`)은 단위 시간당 네트워크를 통해 실제 전송되는 정보량을 의미한다. (bps, Mbps, Gbps 단위로 표현한다.)

`대역폭(BandWidth)`는 단위 시간 동안 통신 매체를 통해 송 수신 할 수 있는 최대 정보량을 의미한다.

https://greencloud33.tistory.com/60

결국 대역폭은 해당 통신 매체에서 단위 시간당 처리할 수 있는 최대치이고, 그중에서 쓰루풋이 실제로 처리되고 있는 처리량이 된다.

